# Tricycle command

## The code

The interesting files are the following:

- brakes.c
- can.c
- dashboard.c
- debug.c
- init.c
- motor.c
- steering.c
- uart.c
- ultrasound.c

They are in the Core/Src folder. You can also find the corresponding header files in the Core/Inc folder.

The main.c file already contains generated code, and we did not like adding our code there. That is why there is a init.c file
containing our own `Main` function.

## Build the project

All other files are generated by CubeMX to configure the GPIO and other peripherals. You should not modify them (or only
between `//USER CODE BEGIN` and `//USER CODE END`).

If you want to configure the peripherals, you should do so in CubeMX and regenerate the code.

Tested usccessfully on CLion by following the tutorial about embedded development. STM32CubeIDE should be easier to configure
though.

## Run the project

Set the jumper to U5 (not E5) to power the Nucleo through USB. Connect the Nucleo to the computer and load the code.

Then, put the jumper back to E5, and switch the power supply on (2 * 24 = 48V), or plug the battery in (black cable, 48V).

Now, you can power the card on by pressing the start button, and power it off by holding the stop button.

You can recharge the battery using the yellow cable and the charger in room 001.

## Notes

There are some weird behaviours with the dashboards button, they can bounce even if nobody touches them. As you will control the
brakes with the CAN, the brakes switch could be in the wrong position compared to the actuator. When a bounce occurs, the
interruption is triggered, which sets the brake to the switch position.

To avoid this, you should handle remote/local switch. When the switch is in the remote position, you will bypass the dashboard,
and when it is in the local position, you will bypass the CAN bus.
